<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=0">
        <title>Cashslide</title>
        <script type="text/javascript" src="https://cdn.rawgit.com/ricmoo/aes-js/e27b99df/index.js"></script>
        <script src="assets/dependencies/sha256.js"></script>
        <script src="assets/dependencies/elliptic.js"></script>
        <script src="assets/dependencies/AES-GCM.js"></script>
        <script src="assets/dependencies/datacash.min.js"></script>
        <script src="assets/dependencies/cashaddrjs-0.3.2.min.js"></script>
        <script src="assets/dependencies/bchaddrjs-0.3.0.min.js"></script>
        <script src="assets/dependencies/simple-bitcoin-wallet.min.js"></script>
        <script src="assets/dependencies/tingle.js"></script>
        <script src="assets/jquery.min.js"></script>
        <script src="assets/chaindm.js"></script>
        <script src="assets/myinfo.js"></script>
        <link rel="stylesheet" type="text/css" href="assets/chaindm.css" media="all">
        <link rel="stylesheet" type="text/css" href="assets/dependencies/tingle.css" media="all">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">
    </head>
    <body>
        <header style="float:right;position: absolute;z-index: 100;width: 100%;">
            <ul class="navmenu" style="max-width: 100%;">
                <li class="logo"><a href="#">Cashslide Beta</a></li>
                <li class="right_button" id="memenavmenu"></li>
            </ul>
        </header>

        <div class="chatwindow">
            <div class="chat_wrapper" style="display:flex;flex-direction:column-reverse;">
                <div id="group_chat">
                    <div style="text-align:center;max-width: 500px;width: 98%;margin: auto;margin-top: 20vh;">
                        <input type="text" id="connect_address" placeholder="Server Address (Cash Address)" value="qz504rd58pvpvnk3ktnl946l6xa2adgwns78mzfnam" required>
                        <input type="text" id="connect_password" placeholder="Optional Server Secret (Encryption Password)">
                        <input type="submit" onclick="meme_clap_connect()" value="Connect">

                        <div id="server_list" style="text-align:left;color:#fff;margin-top:5vh;"></div>

                        <div style="text-align:left;color:#fff;margin-top:3vh;">
                            <a href="" style="background: #1b6ec5;width: 100%;display: block;padding: 8px 10px 8px 10px;border-radius: 3px;box-sizing: border-box;text-align: center;margin-bottom: 10px;cursor: pointer;">Create a Server</a>
                            <a onclick="inviteModal()" style="background: #1b6ec5;width: 100%;display: block;padding: 8px 10px 8px 10px;border-radius: 3px;box-sizing: border-box;text-align: center;margin-bottom: 10px;cursor: pointer;">Redeem Invite Code</a>
                            <a onclick="meme_clap_connect('qz504rd58pvpvnk3ktnl946l6xa2adgwns78mzfnam')" style="background: #1b6ec5;width: 100%;display: block;padding: 8px 10px 8px 10px;border-radius: 3px;box-sizing: border-box;text-align: center;margin-bottom: 10px;cursor: pointer;">Join our Public Test Server</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="message_wrapper" id="addmessageforms"></div>
        </div>
        <script src="/index.js"></script>
        <script src="/assets/loadChat.js"></script>
        <script>
        function meme_clap_connect(address = null, password = null) {
            
            var isCashAddress = bchaddr.isCashAddress;

            if(address == null) {
                var address = $('#connect_address').val();
                myCircle(address);
            } else {
                myCircle(address);
            }
            var password = $('#connect_password').val();

            var addresslenght = address.toString().length;
            var passwordlenght = password.toString().length;

            console.log(passwordlenght);

            if (passwordlenght >= 1 && isCashAddress(address)) {
                initializeGroupChat(address, password);
                console.log('logging in with password and address');
            } else if(isCashAddress(address)) {
                initializeGroupChat(address);
                console.log('logging in with address');
            } else {
                alert('Make sure you entered a valid address');
            }
        }

        array = JSON.parse(localStorage.getItem('JOINED_CHATS'));
        previousChats(array);
        </script>
    </body>
</html>