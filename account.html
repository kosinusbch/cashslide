<!DOCTYPE html>
<html>
    <head>

    </head>
    <body>

        <script>
        function asyncFunction (item, cb) {
            console.log('done with', item);
            cb();
        }

        var restore = JSON.parse(localStorage.getItem('MY_CIRCLE'));

        let requests = restore.reduce((promiseChain, item) => {
            return promiseChain.then(() => new Promise((resolve) => {
                asyncFunction(item, resolve);
            }));
        }, Promise.resolve());

        requests.then(() => {
            console.log('fetching msgs');
            console.log('loading bitsocket');
        })
        </script>
    </body>
</html>